!function(){"use strict";angular.module("app",["ngResource","ngAnimate","ui.router","templates","cfp.hotkeys","focusOn","monospaced.elastic","gettext","diff-match-patch"])}(),function(){"use strict";function t(t,e,n,r){var o=function(t,e){return{request:function(t){return e.$broadcast("loadingStart"),t},requestError:function(n){return e.$broadcast("loadingStop"),console.error("Request error due to ",n),t.reject(n)},response:function(n){return e.$broadcast("loadingStop"),n||t.when(n)},responseError:function(n){return e.$broadcast("loadingStop"),401===n.status?console.error("Unauthorized access. Please login"):404===n.status?console.error("Service end point not found- ",n.config.url):console.error("Error in response ",n),t.reject(n)}}};o.$inject=["$q","$rootScope"],n.interceptors.push(o),e.otherwise("/"),t.state("editor",{url:"/:projectSlug/:versionSlug/translate",templateUrl:"editor/editor.html",controller:"EditorCtrl as editor",resolve:{url:["UrlService",function(t){return t.init()}]}}).state("editor.selectedContext",{url:"/:docId/:localeId",views:{"editor-content":{templateUrl:"editor/editor-content.html",controller:"EditorContentCtrl as editorContent"},"editor-suggestions":{templateUrl:"editor/editor-suggestions.html",controller:"EditorSuggestionsCtrl as editorSuggestions"},"editor-details":{templateUrl:"editor/editor-details.html",controller:"EditorDetailsCtrl as editorDetails"}}}).state("editor.selectedContext.tu",{url:"/?id&selected?states",reloadOnSearch:!1}),r.includeCheatSheet=!1}t.$inject=["$stateProvider","$urlRouterProvider","$httpProvider","hotkeysProvider"],angular.module("app").config(t)}(),function(){"use strict";angular.module("app").constant("_",window._).constant("str",window._.string).constant("Mousetrap",window.Mousetrap).constant("PRODUCTION",!0)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s){function c(){return r.getAllLocales()}function u(){return e.getMyInfo().then(function(t){d.myInfo=t,d.myInfo.locale=r.DEFAULT_LOCALE,d.myInfo.gravatarUrl=n.gravatarUrl(d.myInfo.gravatarHash,72)},function(t){o.displayError("Error loading my info: "+t)})}function l(){r.getUILocaleList().then(function(t){for(var e in t.locales){var n={localeId:t.locales[e],name:""};d.uiLocaleList.push(n)}d.myInfo.locale=r.getLocaleByLocaleId(d.uiLocaleList,r.DEFAULT_LOCALE.localeId),d.myInfo.locale||(d.myInfo.locale=r.DEFAULT_LOCALE)},function(t){o.displayInfo("Error loading UI locale. Default to '"+r.DEFAULT_LOCALE.name+"': "+t),d.myInfo.locale=r.DEFAULT_LOCALE})}var d=this;d.PRODUCTION=s,d.settings=e.settings,d.uiLocaleList=[r.DEFAULT_LOCALE],n.init().then(c).then(u).then(l),d.onChangeUILocale=function(t){d.myInfo.locale=t;var e=d.myInfo.locale.localeId;a.startsWith(e,r.DEFAULT_LOCALE.localeId,!0)?i.setCurrentLanguage(r.DEFAULT_LOCALE.localeId):i.loadRemote(n.uiTranslationURL(e)).then(function(){i.setCurrentLanguage(e)},function(t){o.displayInfo("Error loading UI locale. Default to '"+r.DEFAULT_LOCALE.name+"': "+t),i.setCurrentLanguage(r.DEFAULT_LOCALE),d.myInfo.locale=r.DEFAULT_LOCALE})},d.dashboardPage=function(){return n.DASHBOARD_PAGE}}t.$inject=["$scope","UserService","UrlService","LocaleService","MessageHandler","gettextCatalog","StringUtil","PRODUCTION"],angular.module("app").controller("AppCtrl",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s,c,u,l){function d(){v=o.readValue("status"),u.isUndefined(v)||(v=v.split(","),v=u.transform(v,function(t,e){return e=l.getServerId(e),t.push(e)})),I={status:v}}function f(t,e){var n,r,o,c,l=N.phrases;r=u.findIndex(l,function(t){return t.id===e.currentId}),o=Math.min(r+1,l.length-1),c=l[o].id,c!==e.currentId?i.emitEvent(i.EVENT.SELECT_TRANS_UNIT,{id:c,updateURL:!0,focus:!0},null):(n=l[r],i.emitEvent(i.EVENT.SAVE_TRANSLATION,{phrase:n,status:s.getSaveButtonStatus(n),locale:a.localeId,docId:a.docId}))}function E(t,e){var n,r,o,c,l=N.phrases;r=u.findIndex(l,function(t){return t.id===e.currentId}),o=Math.max(r-1,0),c=l[o].id,c!==e.currentId?i.emitEvent(i.EVENT.SELECT_TRANS_UNIT,{id:c,updateURL:!0,focus:!0},null):(n=l[r],i.emitEvent(i.EVENT.SAVE_TRANSLATION,{phrase:n,status:s.getSaveButtonStatus(n),locale:a.localeId,docId:a.docId}))}function S(t,e){var n,r,o=N.phrases,a=l.getStatusInfo(v);n=u.findIndex(o,function(t){return t.id===e.currentId});for(var s=n+1;s<o.length;s++)if(r=l.getStatusInfo(o[s].state),r.ID===a.ID)return void i.emitEvent(i.EVENT.SELECT_TRANS_UNIT,{id:o[s].id,updateURL:!0,focus:!0},null)}function g(t){T(t),i.emitEvent(i.EVENT.CANCEL_EDIT)}function p(){i.emitEvent(i.EVENT.REFRESH_STATISTIC,{projectSlug:e.context.projectSlug,versionSlug:e.context.versionSlug,docId:e.context.docId,localeId:e.context.localeId}),n.getPhraseCount(e.context,I).then(function(t){e.maxPageIndex=parseInt(t/m),t>m&&(e.maxPageIndex=t%m!==0?e.maxPageIndex+=1:e.maxPageIndex),e.maxPageIndex=e.maxPageIndex-1<0?0:e.maxPageIndex-1,T(e.currentPageIndex)})}function T(t){var r=t*m;n.fetchAllPhrase(e.context,I,r,m).then(h)}function h(t){N.phrases=t}var v,I,m=50,N=this;return d(),N.phrases=[],e.updateContext(a.projectSlug,a.versionSlug,r.decodeDocId(a.docId),a.localeId),p(),t.$on(i.EVENT.FILTER_TRANS_UNIT,function(t,e){if(e.status.all===!0)c.search("status",null);else{var n=[];u.forEach(e.status,function(t,e){t&&n.push(e)}),c.search("status",n.join(","))}d(),p()}),t.$on(i.EVENT.GOTO_FIRST_PAGE,function(){e.currentPageIndex>0&&(e.currentPageIndex=0,g(e.currentPageIndex))}),t.$on(i.EVENT.GOTO_PREV_PAGE,function(){e.currentPageIndex>0&&(e.currentPageIndex-=1,g(e.currentPageIndex))}),t.$on(i.EVENT.GOTO_NEXT_PAGE,function(){e.currentPageIndex<e.maxPageIndex&&(e.currentPageIndex+=1,g(e.currentPageIndex))}),t.$on(i.EVENT.GOTO_LAST_PAGE,function(){e.currentPageIndex<e.maxPageIndex&&(e.currentPageIndex=e.maxPageIndex,g(e.currentPageIndex))}),t.$on(i.EVENT.GOTO_NEXT_ROW,f),t.$on(i.EVENT.GOTO_PREVIOUS_ROW,E),t.$on(i.EVENT.GOTO_NEXT_UNTRANSLATED,S),N}t.$inject=["$rootScope","EditorService","PhraseService","DocumentService","UrlService","EventService","$stateParams","PhraseUtil","$location","_","TransStatusService"],angular.module("app").controller("EditorContentCtrl",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s,c,u,l,d,f,E,S,g,p){function T(){var t=c.readValue("status");g.isUndefined(t)||(t=t.split(","),g.forEach(t,function(t){g.isUndefined(A.filter.status[t])||(A.filter.status[t]=!0)}),v())}function h(t){return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable}function v(t){m(A.filter.status)?I(t):(A.filter.status.all=!1,t&&E.emitEvent(E.EVENT.FILTER_TRANS_UNIT,A.filter))}function I(t){A.filter.status.all=!0,A.filter.status.approved=!1,A.filter.status.translated=!1,A.filter.status.needsWork=!1,A.filter.status.untranslated=!1,t&&E.emitEvent(E.EVENT.FILTER_TRANS_UNIT,A.filter)}function m(t){return t.approved===t.translated&&t.translated===t.needsWork&&t.needsWork===t.untranslated}function N(){O()&&l.go("editor.selectedContext",{docId:A.context.docId,localeId:A.context.localeId})}function O(){return A.context.docId&&A.context.localeId}function _(t,e,r,o){n.getStatistics(t,e,r,o).then(function(t){A.wordStatistic=s.getWordStatistic(t),A.messageStatistic=s.getMsgStatistic(t)},function(t){d.displayError("Error loading statistic: "+t)})}var A=this;A.pageNumber=1,A.showCheatsheet=!1,A.shortcuts=g.mapValues(g.values(S.SHORTCUTS),function(t){var e=g.flatten(t.keyCombos,"combo");return{combos:g.map(e,function(t){return S.symbolizeKey(t)}),description:t.keyCombos[0].description}}),A.filter={status:{all:!0,approved:!1,translated:!1,needsWork:!1,untranslated:!1}},T(),p.bind("?",function(e){var n=e.srcElement;A.showCheatsheet||h(n)||(A.toggleKeyboardShortcutsModal(),t.$digest())},"keyup"),A.context=i.initContext(u.projectSlug,u.versionSlug,n.decodeDocId(u.docId),r.DEFAULT_LOCALE,r.DEFAULT_LOCALE.localeId,"READ_WRITE"),A.toggleKeyboardShortcutsModal=function(){A.showCheatsheet=!A.showCheatsheet};var C=a.SETTING.SHOW_SUGGESTIONS;t.showSuggestions=a.subscribe(C,function(e){t.showSuggestions=e}),A.toggleSuggestionPanel=function(){a.update(C,!t.showSuggestions)},A.versionPage=function(){return c.PROJECT_PAGE(A.context.projectSlug,A.context.versionSlug)},A.encodeDocId=function(t){return n.encodeDocId(t)},o.getProjectInfo(u.projectSlug).then(function(t){A.projectInfo=t},function(t){d.displayError("Error getting project information:"+t)}),r.getSupportedLocales(A.context.projectSlug,A.context.versionSlug).then(function(t){if(A.locales=t,!A.locales||A.locales.length<=0)d.displayError("No supported locales in "+A.context.projectSlug+" : "+A.context.versionSlug);else{var e=l.params.localeId,n=A.context;e?(n.localeId=e,r.containsLocale(A.locales,e)||(n.localeId=A.locales[0].localeId)):(n.localeId=A.locales[0].localeId,N())}},function(t){d.displayError("Error getting locale list: "+t)}),n.findAll(A.context.projectSlug,A.context.versionSlug).then(function(t){if(A.documents=t,!A.documents||A.documents.length<=0)d.displayError("No documents in "+A.context.projectSlug+" : "+A.context.versionSlug);else{var e=l.params.docId,r=A.context;e?(r.docId=n.decodeDocId(e),n.containsDoc(A.documents,r.docId)||(r.docId=A.documents[0].name)):(r.docId=A.documents[0].name,N())}},function(t){d.displayError("Error getting document list: "+t)}),f.$on(E.EVENT.SELECT_TRANS_UNIT,function(t,e){A.unitSelected=e.id,A.focused=e.focus}),f.$on(E.EVENT.CANCEL_EDIT,function(){A.unitSelected=!1,A.focused=!1}),f.$on(E.EVENT.REFRESH_STATISTIC,function(t,e){_(e.projectSlug,e.versionSlug,e.docId,e.localeId),A.context.docId=e.docId,A.context.localeId=e.localeId}),A.pageNumber=function(){return 0===i.maxPageIndex?i.currentPageIndex+1:i.currentPageIndex+1+" of "+(i.maxPageIndex+1)},A.getLocaleName=function(t){return r.getName(t)},A.firstPage=function(){E.emitEvent(E.EVENT.GOTO_FIRST_PAGE)},A.lastPage=function(){E.emitEvent(E.EVENT.GOTO_LAST_PAGE)},A.nextPage=function(){E.emitEvent(E.EVENT.GOTO_NEXT_PAGE)},A.previousPage=function(){E.emitEvent(E.EVENT.GOTO_PREV_PAGE)},A.resetFilter=function(){I(!0)},A.updateFilter=function(){v(!0)},this.settings=e.settings.editor,S.enableEditorKeys()}t.$inject=["$scope","UserService","DocumentService","LocaleService","ProjectService","EditorService","SettingsService","StatisticUtil","UrlService","$stateParams","$state","MessageHandler","$rootScope","EventService","EditorShortcuts","_","Mousetrap"],angular.module("app").controller("EditorCtrl",t)}(),function(){"use strict";function t(){var t=this;return t}angular.module("app").controller("EditorDetailsCtrl",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s,c,u){function l(t,e){return a.hasTranslationChanged(t)||t.status!==e}function d(t){var a=n.cloneDeep(E.context),l=S[t],d=e(r.TRANSLATION_URL,{},{update:{method:"PUT",params:{localeId:l.locale}}}),f={id:l.phrase.id,revision:l.phrase.revision||0,content:l.phrase.newTranslations[0],contents:l.phrase.newTranslations,status:u.getServerId(l.status.ID),plural:l.phrase.plural};d.update(f).$promise.then(function(t){var e=l.phrase.status.ID;i.onTransUnitUpdated(a,f.id,l.locale,t.revision,t.status,l.phrase),s.updateStatistic(a.projectSlug,a.versionSlug,l.docId,l.locale,e,u.getId(t.status),l.phrase.wordCount),o.emitEvent(o.EVENT.SAVE_COMPLETED,l.phrase)},function(t){c.displayWarning("Update translation failed for "+f.id+" -"+t),i.onTransUnitUpdateFailed(f.id),o.emitEvent(o.EVENT.SAVE_COMPLETED,l.phrase)}),delete S[t]}function f(t,e){return n.isEmpty(n.compact(t.newTranslations))?u.getStatusInfo("UNTRANSLATED"):e}var E=this,S={};return E.context={},E.currentPageIndex=0,E.maxPageIndex=0,E.initContext=function(t,e,n,r,o,i){return E.context={projectSlug:t,versionSlug:e,docId:n,srcLocale:r,localeId:o,mode:i},E.context},E.updateContext=function(t,e,n,r){E.context.projectSlug!==t&&(E.context.projectSlug=t),E.context.versionSlug!==e&&(E.context.versionSlug=e),E.context.docId!==n&&(E.context.docId=n),E.context.localeId!==r&&(E.context.localeId=r)},t.$on(o.EVENT.SAVE_TRANSLATION,function(t,e){var r=e.phrase,i=e.status;if(l(r,i)){if(n.has(S,r.id)){var a=S[r.id];a.phrase=r,a.status=i}else i=f(r,i),S[r.id]={phrase:r,status:i,locale:e.locale,docId:e.docId};o.emitEvent(o.EVENT.SAVE_INITIATED,e),d(r.id)}}),E}t.$inject=["$rootScope","$resource","_","UrlService","EventService","PhraseService","PhraseUtil","DocumentService","MessageHandler","TransStatusService"],angular.module("app").factory("EditorService",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s,c){function u(e){m.selectedTUCtrl&&(e.preventDefault(),t.emitEvent(t.EVENT.COPY_FROM_SOURCE,{phrase:m.selectedTUCtrl.getPhrase()}))}function l(e){m.selectedTUCtrl&&(e.preventDefault(),e.stopPropagation(),t.emitEvent(t.EVENT.GOTO_NEXT_ROW,v()))}function d(e){m.selectedTUCtrl&&(e.preventDefault(),e.stopPropagation(),t.emitEvent(t.EVENT.GOTO_PREVIOUS_ROW,v()))}function f(e){if(e.preventDefault(),e.stopPropagation(),N)m.cancelSaveAsModeIfOn(),m.selectedTUCtrl&&m.selectedTUCtrl.focusTranslation();else if(m.selectedTUCtrl){var n=m.selectedTUCtrl.getPhrase();o.hasTranslationChanged(n)?t.emitEvent(t.EVENT.UNDO_EDIT,n):t.emitEvent(t.EVENT.CANCEL_EDIT,n)}}function E(n){if(m.selectedTUCtrl){n.preventDefault();var r=m.selectedTUCtrl.getPhrase();t.emitEvent(t.EVENT.SAVE_TRANSLATION,{phrase:r,status:o.getSaveButtonStatus(r),locale:e.localeId,docId:e.docId})}}function S(e){e.preventDefault(),m.cancelSaveAsModeIfOn();var n=m.selectedTUCtrl.getPhrase();n&&(t.emitEvent(t.EVENT.TOGGLE_SAVE_OPTIONS,{id:n.id,open:!0}),I(n,"n","needsWork"),I(n,"t","translated"),I(n,"a","approved"))}function g(e){return function(n){n.preventDefault(),t.emitEvent(t.EVENT.COPY_FROM_SUGGESTION_N,e-1)}}function p(t,e,n,r,o){return this.defaultKey=t,this.keyCombos=[T(t,n,o,e)],r&&(this.otherKeys=r instanceof Array?r:[r],this.keyCombos.push(T(this.otherKeys,"",o,e))),this}function T(t,e,n,r){var o={allowIn:["TEXTAREA"],callback:r};return o.combo=t,e&&(o.description=e),n&&(o.action=n),o}function h(t){r.get(t.defaultKey)||n.forEach(t.keyCombos,function(t){r.add(t)})}function v(){return{currentId:m.selectedTUCtrl.getPhrase().id}}function I(t,e,n){var o=i.getStatusInfo(n);return r.add({combo:e,description:s.sprintf("Save as %s",n),allowIn:["INPUT","TEXTAREA"],action:"keydown",callback:function(e){m.saveTranslationCallBack(e,t,o)}})}var m=this,N=!1;return m.selectedTUCtrl=null,m.SHORTCUTS={COPY_SOURCE:new p("alt+c",u,"Copy source as translation","alt+g"),COPY_SUGGESTION_1:new p("mod+alt+1",g(1),"Copy first suggestion as translation"),COPY_SUGGESTION_2:new p("mod+alt+2",g(2),"Copy second suggestion as translation"),COPY_SUGGESTION_3:new p("mod+alt+3",g(3),"Copy third suggestion as translation"),COPY_SUGGESTION_4:new p("mod+alt+4",g(4),"Copy fourth suggestion as translation"),CANCEL_EDIT:new p("esc",f,"Cancel edit"),SAVE_AS_CURRENT_BUTTON_OPTION:new p("mod+s",E,"Save"),SAVE_AS_MODE:new p("mod+shift+s",S,"Save as…"),SAVE_AS_NEEDSWORK:{keyCombos:[{combo:"mod+shift+s n",description:"Save as needs work"}]},SAVE_AS_TRANSLATED:{keyCombos:[{combo:"mod+shift+s t",description:"Save as translated"}]},SAVE_AS_APPROVED:{keyCombos:[{combo:"mod+shift+s a",description:"Save as approved"}]},GOTO_NEXT_ROW_FAST:new p("mod+enter",l,"Save (if changed) and go to next string",["alt+k","alt+down"]),GOTO_PREVIOUS_ROW:new p("mod+shift+enter",d,"Save (if changed) and go to previous string",["alt+j","alt+up"])},m.enableEditorKeys=function(){r.get(m.SHORTCUTS.COPY_SOURCE.defaultKey)||n.forOwn(m.SHORTCUTS,function(t){t instanceof p&&h(t)})},m.disableEditorKeys=function(){n.forOwn(m.SHORTCUTS,function(t){n.forEach(t.keyCombos,function(t){m.deleteKeys(t.combo,t.action)})})},m.saveTranslationCallBack=function(n,r,o){N=!0,n.preventDefault(),n.stopPropagation(),t.emitEvent(t.EVENT.SAVE_TRANSLATION,{phrase:r,status:o,locale:e.localeId,docId:e.docId}),m.cancelSaveAsModeIfOn()},m.cancelSaveAsModeIfOn=function(){N&&m.selectedTUCtrl&&(N=!1,m.deleteKeys(["n","t","a"]),t.emitEvent(t.EVENT.TOGGLE_SAVE_OPTIONS,{id:m.selectedTUCtrl.getPhrase().id,open:!1}))},m.deleteKeys=function(t,e){var o=t instanceof Array?t:[t];e=e||"keydown",n.forEach(o,function(t){r.del(t),a.unbind(t,e)})},m.symbolizeKey=function(t){var e={command:"⌘",shift:"⇧",left:"←",right:"→",up:"↑",down:"↓","return":"↩",backspace:"⌫"};t=t.split("+");for(var n=0;n<t.length;n++)"mod"===t[n]&&(t[n]=c.navigator&&c.navigator.platform.indexOf("Mac")>=0?"command":"ctrl"),t[n]=e[t[n]]||t[n];return t.join(" + ")},m}t.$inject=["EventService","$stateParams","_","hotkeys","PhraseUtil","TransStatusService","Mousetrap","str","$window"],angular.module("app").factory("EditorShortcuts",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s){function c(n){var r=[];r=e.chain(n).sortBy(["similarityPercent","relevanceScore"]).reverse().value(),h.searchIsText||l(r),t.searchIsVisible?(d(h.searchPhrase,r),h.searchResultsTotal=h.suggestions.length):(d(h.currentSearchPhrase,r),h.searchResultsTotal=0),t.searchIsLoading=!1}function u(t){h.currentSearchPhrase=t}function l(t){h.currentPhraseSuggestions=t}function d(t,e){h.searchPhrase=t,h.suggestions=e}function f(){a(function(){h.searchPhrase=h.currentSearchPhrase,h.suggestions=h.currentPhraseSuggestions})}function E(){t.searchIsVisible=!1,h.clearSearchResults(null,!0),h.unitSelected&&(h.searchIsText=!1,f())}function S(e,n){t.searchIsVisible=!0,!n&&e&&t.focusSearch(e),h.searchForText("")}function g(t){console.error("It's over! ",t)}var p=n.SETTING.SHOW_SUGGESTIONS,T=n.SETTING.SUGGESTIONS_SHOW_DIFFERENCE,h=this;return h.suggestions=[],h.searchPhrase=null,h.searchResultsTotal=0,h.searchText="",h.searchDisplayRequired=!1,h.searchIsText=!1,h.unitSelected=!1,t.searchIsVisible=!1,t.searchIsLoading=!1,t.show=n.subscribe(p,function(e){t.show=e}),t.diff=n.subscribe(T,function(e){t.diff=e}),t.focusSearch=function(t){t&&t.preventDefault(),s("searchSugInput")},h.closeSuggestions=function(){n.update(p,!1),o.emitEvent(o.EVENT.SUGGESTIONS_SEARCH_TOGGLE,!1)},h.clearSearchResults=function(e,n){h.searchText="",h.suggestions=[],!n&&e&&t.focusSearch(e)},h.searchForText=function(t){h.searchIsText=!0,a.cancel(h.searchInProgress),h.searchInProgress=a(function(){o.emitEvent(o.EVENT.REQUEST_TEXT_SUGGESTIONS,t)},300)},h.toggleSearch=function(){t.searchIsVisible?o.emitEvent(o.EVENT.SUGGESTIONS_SEARCH_TOGGLE,!1):o.emitEvent(o.EVENT.SUGGESTIONS_SEARCH_TOGGLE,!0)},!h.unitSelected&&t.show&&(h.searchDisplayRequired=!0,S()),i.$on(o.EVENT.SELECT_TRANS_UNIT,function(e,n){h.unitSelected=n.id,""===h.searchText&&t.searchIsVisible&&o.emitEvent(o.EVENT.SUGGESTIONS_SEARCH_TOGGLE,!1),h.searchDisplayRequired=!1}),i.$on(o.EVENT.CANCEL_EDIT,function(){t.show&&(S(null,!0),h.searchDisplayRequired=!0)}),i.$on(o.EVENT.SUGGESTIONS_SEARCH_TOGGLE,function(t,e){e?S(t):E(t)}),i.$on(o.EVENT.REQUEST_PHRASE_SUGGESTIONS,function(t,e){h.searchIsText=!1,r.getSuggestionsForPhrase(e.phrase).then(c,g),u(e.phrase)}),i.$on(o.EVENT.REQUEST_TEXT_SUGGESTIONS,function(e,n){return""===n?(c(""),!1):(t.searchIsLoading=!0,r.getSuggestionsForText(n).then(c,g),void(h.searchPhrase=n))}),h}t.$inject=["$scope","_","SettingsService","SuggestionsService","EventService","$rootScope","$timeout","focus"],angular.module("app").controller("EditorSuggestionsCtrl",t)}(),function(){"use strict";function t(){return{restrict:"A",link:function(t,e,n){return t.$on("blurOn",function(t,r){return r===n.blurOn?e[0].blur():void 0})}}}angular.module("app").directive("blurOn",t)}(),function(){"use strict";function t(t){return{restrict:"A",scope:{callback:"&clickElsewhere"},link:function(e,n){var r=function(t){n[0].contains(t.target)||e.$apply(e.callback(t))};t.on("click",r),e.$on("$destroy",function(){t.off("click",r)})}}}t.$inject=["$document"],angular.module("app").directive("clickElsewhere",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s){function c(t,e){return t+"-"+e}function u(t,e,n,r){var i=o.getWordStatistic(t),a=o.getMsgStatistic(t);if(i){r=parseInt(r);var s=parseInt(i[e])-r;i[e]=0>s?0:s,i[n]=parseInt(i[n])+r}if(a){var c=parseInt(a[e])-1;a[e]=0>c?0:c,a[n]=parseInt(a[n])+1}}var l=this,d={};return l.findAll=function(t,r){var o=e(n.DOCUMENT_LIST_URL,{},{query:{method:"GET",params:{projectSlug:t,versionSlug:r},isArray:!0}});return o.query().$promise},l.getStatistics=function(r,o,i,u){if(i&&u){var f=c(i,u);if(a.has(d,f))return t.when(d[f]);var E=l.encodeDocId(i),S=e(n.DOC_STATISTIC_URL,{},{query:{method:"GET",params:{projectSlug:r,versionSlug:o,docId:E,localeId:u},isArray:!0}});return S.query().$promise.then(function(t){return a.forEach(t,function(t){t[s.getId("needswork")]=t.needReview||0}),d[f]=t,d[f]})}},l.encodeDocId=function(t){return t?t.replace(/\//g,","):t},l.decodeDocId=function(t){return t?t.replace(/\,/g,"/"):t},l.containsDoc=function(t,e){return a.any(t,function(t){return r.equals(t.name,e,!0)})},l.updateStatistic=function(t,e,n,r,o,s,l){var f=c(n,r);a.has(d,f)&&(u(d[f],o,s,l),i.emitEvent(i.EVENT.REFRESH_STATISTIC,{projectSlug:t,versionSlug:e,docId:n,localeId:r}))},l}t.$inject=["$q","$resource","UrlService","StringUtil","StatisticUtil","EventService","_","TransStatusService"],angular.module("app").factory("DocumentService",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a){var s,c=this,u=t.$new(),l=r.openClass,d=angular.noop,f=e.onToggle?n(e.onToggle):angular.noop;this.init=function(r){c.$element=r,e.isOpen&&(s=n(e.isOpen),d=s.assign,t.$watch(s,function(t){u.isOpen=!!t}))},this.toggle=function(t){return u.isOpen=arguments.length?!!t:!u.isOpen,u.isOpen},this.isOpen=function(){return u.isOpen},u.getToggleElement=function(){return c.toggleElement},u.focusToggleElement=function(){c.toggleElement&&c.toggleElement[0].focus()},u.$watch("isOpen",function(e,n){i[e?"addClass":"removeClass"](c.$element,l),e?(a(function(){u.focusToggleElement()}),o.open(u)):o.close(u),d(t,e),angular.isDefined(e)&&e!==n&&f(t,{open:!!e})}),t.$on("$locationChangeSuccess",function(){u.isOpen=!1}),t.$on("$destroy",function(){u.$destroy()}),t.$on("openDropdown",function(){u.isOpen=!0}),t.$on("closeDropdown",function(){u.isOpen=!1})}t.$inject=["$scope","$attrs","$parse","dropdownConfig","DropdownService","$animate","$timeout"],angular.module("app").controller("DropdownCtrl",t)}(),function(){"use strict";function t(t){var e=null,n=this;n.open=function(n){e||(t.bind("click",r),t.bind("keydown",o)),e&&e!==n&&(e.isOpen=!1),e=n},n.close=function(n){e===n&&(e=null,t.unbind("click",r),t.unbind("keydown",o))};var r=function(t){if(e){var n=e.getToggleElement();t&&n&&n[0].contains(t.target)||e.$apply(function(){e.isOpen=!1})}},o=function(t){27===t.which&&(e.focusToggleElement(),r())}}t.$inject=["$document"],angular.module("app").service("DropdownService",t)}(),function(){"use strict";var t={openClass:"is-active"};angular.module("app").constant("dropdownConfig",t)}(),function(){"use strict";function t(){return{restrict:"EA",controller:"DropdownCtrl",link:function(t,e,n,r){r.init(e)}}}function e(){return{restrict:"A",require:"?^dropdown",scope:{callback:"&onCloseDropdown"},link:function(t,e,n,r){r.onCloseDropdown=t.callback}}}function n(){return{restrict:"EA",require:"?^dropdown",link:function(t,e,n,r){if(r){r.toggleElement=e;var o=function(o){o.preventDefault(),o.stopPropagation(),e.hasClass("disabled")||n.disabled||t.$apply(function(){r.toggle()})};e.bind("click",o),e.attr({"aria-haspopup":!0,"aria-expanded":!1}),t.$watch(r.isOpen,function(n){e.attr("aria-expanded",!!n),r.onCloseDropdown&&!n&&t.$applyAsync(r.onCloseDropdown)}),t.$on("$destroy",function(){e.unbind("click",o)})}}}}angular.module("app").directive("dropdown",t).directive("onCloseDropdown",e).directive("dropdownToggle",n)}(),function(){"use strict";function t(t){var e=this;return e.EVENT={LOADING_START:"loadingStart",LOADING_STOP:"loadingStop",SELECT_TRANS_UNIT:"selectTransUnit",COPY_FROM_SOURCE:"copyFromSource",COPY_FROM_SUGGESTION:"copyFromSuggestion",COPY_FROM_SUGGESTION_N:"copyFromSuggestionN",UNDO_EDIT:"undoEdit",CANCEL_EDIT:"cancelEdit",FOCUS_TRANSLATION:"focusTranslation",SAVE_TRANSLATION:"saveTranslation",SAVE_INITIATED:"saveInitiated",SAVE_COMPLETED:"saveCompleted",TRANSLATION_TEXT_MODIFIED:"translationTextModified",REFRESH_STATISTIC:"refreshStatistic",GOTO_PREV_PAGE:"gotoPreviousPage",GOTO_NEXT_PAGE:"gotoNextPage",GOTO_FIRST_PAGE:"gotoFirstPage",GOTO_LAST_PAGE:"gotoLastPage",GOTO_NEXT_ROW:"gotoNextRow",GOTO_PREVIOUS_ROW:"gotoPreviousRow",GOTO_NEXT_UNTRANSLATED:"gotoNextUntranslated",TOGGLE_SAVE_OPTIONS:"openSaveOptions",FILTER_TRANS_UNIT:"filterTransUnit",PHRASE_SUGGESTION_COUNT:"phraseSuggestionCount",REQUEST_PHRASE_SUGGESTIONS:"requestPhraseSuggestions",REQUEST_TEXT_SUGGESTIONS:"requestTextSuggestions",SUGGESTIONS_SEARCH_TOGGLE:"suggestionsSearchToggle",USER_SETTING_CHANGED:"userSettingChanged"},e.broadcastEvent=function(e,n,r){r=r||t,r.$broadcast(e,n)},e.emitEvent=function(e,n,r){r=r||t,r.$emit(e,n)},e}t.$inject=["$rootScope"],angular.module("app").factory("EventService",t)}(),function(){"use strict";function t(t){return{restrict:"E",required:["name"],scope:{name:"@",title:"@",size:"@"},link:function(e,n){var r="",o="";n.addClass("Icon"),e.title&&(o="<title>"+e.title+"</title>"),r='<svg class="Icon-item"><use xlink:href="#Icon-'+e.name+'" />'+o+"</svg>",n.html(t.trustAsHtml(r))}}}t.$inject=["$sce"],angular.module("app").directive("icon",t)}(),function(){"use strict";function t(t,e,n,r,o){function i(e,n){var o=r(t.LOCALE_LIST_URL,{},{query:{method:"GET",params:{projectSlug:e,versionSlug:n},isArray:!0}});return o.query().$promise}function a(){var e=r(t.ALL_LOCALE_URL,{},{query:{method:"GET",isArray:!0}});return e.query().$promise.then(function(t){d=n.cleanResourceList(t)})}function s(){var e=r(t.uiTranslationListURL,{},{query:{method:"GET"}});return e.query().$promise}function c(t,n){return t?o.find(t,function(t){return e.equals(t.localeId,n,!0)}):void 0}function u(t,n){return o.any(t,function(t){return e.equals(t.localeId,n,!0)})}function l(t){var e=c(d,t);return e?e.name:t}var d=[];return{getSupportedLocales:i,getUILocaleList:s,getLocaleByLocaleId:c,getAllLocales:a,containsLocale:u,getName:l,DEFAULT_LOCALE:{localeId:"en-US",name:"English"}}}t.$inject=["UrlService","StringUtil","FilterUtil","$resource","_"],angular.module("app").factory("LocaleService",t)}(),function(){"use strict";function t(t){return{restrict:"EA",scope:{loading:"=",inverted:"="},link:function(e){e.classes="",e.$on(t.EVENT.LOADING_START,function(){e.classes+=" is-loading"}),e.$on(t.EVENT.LOADING_STOP,function(){e.classes=e.classes.replace("is-loading","")}),e.$watch("inverted",function(t){t?e.classes+=" LogoLoader--inverted":e.classes=e.classes.replace("LogoLoader--inverted","")})},templateUrl:"components/logo-loader/logo-loader.html"}}t.$inject=["EventService"],angular.module("app").directive("logoLoader",t)}(),function(){"use strict";function t(){return{displayError:function(t){console.error(t)},displayWarning:function(t){console.warn(t)},displayInfo:function(t){console.info(t)}}}angular.module("app").factory("MessageHandler",t)}(),function(){"use strict";function t(){}angular.module("app").factory("NotificationService",t)}(),function(){"use strict";function t(t,e,n,r,o,i){function a(t,e,n,r){return t+"-"+e+"-"+n+"-"+r}var s=this,c={},u={};return s.getStates=function(s,u,l,d){var f=a(s,u,l,d);if(i.has(c,f))return t.when(c[f]);var E=o.encodeDocId(l),S={query:{method:"GET",params:{projectSlug:s,versionSlug:u,docId:E,localeId:d},isArray:!0}},g=e(r.TRANSLATION_STATUS_URL,{},S);return g.query().$promise.then(function(t){return t=n.cleanResourceList(t),c[f]=t,c[f]})},s.getTransUnits=function(o,a){function s(t){t=n.cleanResourceMap(t);for(var e in t)u[e][a]=t[e][a],l[e]=u[e];return l}function c(t){t=n.cleanResourceMap(t);for(var e in t)u[e]=t[e],l[e]=u[e];return l}var l={},d=[],f=[];if(o.forEach(function(t){i.has(u,t)?u[t][a]?l[t]=u[t]:f.push(t):d.push(t)}),i.isEmpty(d)&&i.isEmpty(f))return t.when(l);var E,S;return i.isEmpty(d)||(E=e(r.TEXT_FLOWS_URL,{},{query:{method:"GET",params:{localeId:a,ids:d.join(",")}}})),i.isEmpty(f)||(S=e(r.TRANSLATION_URL,{},{query:{method:"GET",params:{localeId:a,ids:f.join(",")}}})),E&&S?E.query().$promise.then(c).then(S.query().$promise.then(s)):E?E.query().$promise.then(c):S?S.query().$promise.then(s):void 0},s.onTransUnitUpdated=function(t,e,n,r,o,s){var l=a(t.projectSlug,t.versionSlug,t.docId,n),d=i.find(c[l],function(t){return t.id===e});d&&(d.state=o);var f=u[e][n];f||(f={}),f.revision=parseInt(r),f.state=o,f.contents=s.newTranslations.slice()},s}t.$inject=["$q","$resource","FilterUtil","UrlService","DocumentService","_"],angular.module("app").factory("PhraseCache",t)}(),function(){"use strict";function t(t,e,n,r,o){function i(t,e){return r.find(e,function(e){return e.id===t})}function a(e,n){return n&&(e=t.filterResources(e,["status"],n)),r.map(e,function(t){return t.id})}var s={};return s.phrases=[],s.getPhraseCount=function(t,n){return e.getStates(t.projectSlug,t.versionSlug,t.docId,t.localeId).then(function(t){var e=a(t,n.status);return e.length})},s.fetchAllPhrase=function(t,o,i,c){function u(t){var n=a(t,o.status);return isNaN(i)||(n=isNaN(c)?n.slice(i):n.slice(i,i+c)),e.getTransUnits(n,E).then(l).then(f)}function l(t){return r.map(t,function(t,e){var r=t.source,o=t[E];return{id:parseInt(e),sources:r.plural?r.contents:[r.content],translations:d(r,o),newTranslations:d(r,o),plural:r.plural,status:n.getStatusInfo(o?o.state:"untranslated"),revision:o?parseInt(o.revision):0,wordCount:parseInt(r.wordCount)}})}function d(t,e){return t.plural?e&&e.contents?e.contents.slice():[]:e?[e.content]:[]}function f(n){return e.getStates(t.projectSlug,t.versionSlug,t.docId,E).then(function(t){return s.phrases=r.sortBy(n,function(e){var o=r.findIndex(t,function(t){return t.id===e.id});return o>=0?o:n.length}),s.phrases})}var E=t.localeId;return e.getStates(t.projectSlug,t.versionSlug,t.docId,E).then(u)},s.onTransUnitUpdated=function(t,r,o,a,c,u){e.onTransUnitUpdated(t,r,o,a,c,u);var l=i(r,s.phrases);l&&(l.translations=u.newTranslations.slice(),l.revision=a,l.status=n.getStatusInfo(c))},s.onTransUnitUpdateFailed=function(t){var e=i(t,s.phrases);e&&(e.newTranslations=e.translations.slice())},s.findNextId=function(t){return e.getStates(o.projectSlug,o.versionSlug,o.docId,o.localeId).then(function(e){var n,o;return n=r.findIndex(e,function(e){return e.id===t}),o=n+1<e.length?n+1:e.length-1,e[o].id})},s.findPreviousId=function(t){return e.getStates(o.projectSlug,o.versionSlug,o.docId,o.localeId).then(function(e){var n,o;return n=r.findIndex(e,function(e){return e.id===t}),o=n-1>=0?n-1:0,e[o].id})},s.findNextStatus=function(t,i){return e.getStates(o.projectSlug,o.versionSlug,o.docId,o.localeId).then(function(e){var o,a,s=n.getStatusInfo(i);o=r.findIndex(e,function(e){return e.id===t});for(var c=o+1;c<e.length;c++)if(a=n.getStatusInfo(e[c].state),a.ID===s.ID)return e[c].id;return t})},s}t.$inject=["FilterUtil","PhraseCache","TransStatusService","_","$stateParams"],angular.module("app").factory("PhraseService",t)}(),function(){"use strict";function t(){return{restrict:"E",required:"progressbarStatistic",scope:{statistic:"=progressbarStatistic",size:"@"},templateUrl:"components/progressbar/progressbar.html",controller:["$scope",function(t){t.$watch("statistic",function(n){n&&(t.style=e(n))},!0)}]}}function e(t){var e=t.total,r=n(t.approved,e),o=n(t.translated,e),i=r,a=n(t.needswork,e),s=r+o,c=n(t.untranslated,e),u=r+o+a,l={};return l.approved={width:r+"%",marginLeft:0},l.translated={width:o+"%",marginLeft:i+"%"},l.needsWork={width:a+"%",marginLeft:s+"%"},l.untranslated={width:c+"%",marginLeft:u+"%"},l}function n(t,e){var n=0;return t&&(n=t/e*100),n}angular.module("app").directive("progressbar",t)}(),function(){"use strict";function t(t,e){function n(n){var r={query:{method:"GET",params:{projectSlug:n}}},o=e(t.PROJECT_URL,{},r);return o.query().$promise}return{getProjectInfo:n}}t.$inject=["UrlService","$resource"],angular.module("app").factory("ProjectService",t)}(),function(){"use strict";function t(){function t(t,e){return t.replace(e.regex,e.template)}var e={space:{regex:/ /g,template:'<span class="u-textSpace"> </span>'},newline:{regex:/\n/g,template:'<span class="u-textPilcrow"></span>\n'},tab:{regex:/\t/g,template:'<span class="u-textTab">	</span>'}};
return{restrict:"A",required:["ngBind"],scope:{ngBind:"="},link:function(n,r){n.$watch("ngBind",function(n){n=t(n,e.space),n=t(n,e.newline),n=t(n,e.tab),r.html(n)})}}}angular.module("app").directive("renderWhitespaceCharacters",t)}(),function(){"use strict";function t(t,e,n,r){function o(o,i,a){function s(){t.update(t.SETTING.SUGGESTIONS_PANEL_HEIGHT,o.actualPosition)}function c(t){if(t)o.actualPosition=o.position,o.actualHeight=o.height;else{var e=o.actualPosition;o.position=e,o.actualPosition=0,o.actualHeight=0}setTimeout(E)}function u(t){"vertical"===a.resizer?l(t.pageX):d(e.innerHeight-t.pageY)}function l(t){var n=t,r=angular.element(document.querySelector(a.resizerLeft)),s=angular.element(document.querySelector(a.resizerRight)),c=g(a.resizerMax,e.innerHeight),u=a.resizerMin||parseInt(a.resizerWidth);o.actualPosition=n,n=S(n,c,u),i.css({left:n-o.actualHeight/2+"px"}),r.css({width:n+"px"}),s.css({left:n+"px"})}function d(t){var n=t,r=angular.element(document.querySelector(a.resizerTop)),s=angular.element(document.querySelector(a.resizerBottom)),c=g(a.resizerMax,e.innerHeight),u=a.resizerMin||o.actualHeight;o.actualPosition=n,n=S(n,c,u),i.css({bottom:n-o.actualHeight/2+"px"}),r.css({bottom:n+"px"}),s.css({height:n+"px"})}function f(){n.unbind("mousemove",u),n.unbind("mouseup",f),s()}function E(){"vertical"===a.resizer?l(o.actualPosition):d(o.actualPosition)}function S(t,e,n){return e&&t>e?e:n>t?n:t}function g(t,e){return/[0-9]*\.?[0-9]+%/.test(t)?Math.round(e*(parseInt(t.replace("%",""))/100)):parseInt(t)}o.height=parseInt(a.resizerHeight),o.actualHeight=o.height,o.position=g(t.get(t.SETTING.SUGGESTIONS_PANEL_HEIGHT),e.innerHeight),o.actualPosition=o.position,o.show=t.subscribe(t.SETTING.SHOW_SUGGESTIONS,function(t){o.show=t,c(t)}),c(o.show),i.addClass("Resizer"),"vertical"===a.resizer?(i.addClass("Resizer--vertical"),r(function(){l(o.actualPosition)})):(i.addClass("Resizer--horizontal"),r(function(){d(o.actualPosition)})),i.on("mousedown",function(t){t.preventDefault(),n.on("mousemove",u),n.on("mouseup",f)}),angular.element(e).bind("resize",function(){r.cancel(o.resizing),o.resizing=r(E)})}return{link:o}}t.$inject=["SettingsService","$window","$document","$timeout"],angular.module("app").directive("resizer",t)}(),function(){"use strict";function t(){var t=this;t.init=function(){var e=t.container[0],n=t.child[0],r=n.offsetWidth-e.offsetWidth;t.width=r/2}}angular.module("app").controller("ScrollbarWidthCtrl",t)}(),function(){"use strict";function t(){return{restrict:"A",controller:"ScrollbarWidthCtrl as scrollbarWidthCtrl",link:function(t,e,n,r){r.init(e)}}}function e(){return{restrict:"A",require:"?^scrollbarWidth",link:function(t,e,n,r){r&&e.css(n.scrollbarWidthElement,r.width)}}}function n(){return{restrict:"A",require:"?^scrollbarWidth",link:function(t,e,n,r){r&&(r.container=e)}}}function r(){return{restrict:"A",require:"?^scrollbarWidth",link:function(t,e,n,r){r&&(r.child=e)}}}angular.module("app").directive("scrollbarWidth",t).directive("scrollbarWidthElement",e).directive("scrollbarWidthContainer",n).directive("scrollbarWidthChild",r)}(),function(){"use strict";function t(t,e,n,r){function o(e,n){c(n);var o={};o[e]=n,r.extend(f,o),t.emitEvent(t.EVENT.USER_SETTING_CHANGED,{setting:e,value:n})}function i(t){r.each(t,function(t,e){o(e,t)})}function a(t){return r.has(f,t)?f[t]:void console.error("Tried to look up setting with unrecognized key: %s",t)}function s(e,r){return n.$on(t.EVENT.USER_SETTING_CHANGED,function(t,n){n.setting===e&&r(n.value)}),a(e)}function c(t){switch(typeof t){case"boolean":case"number":case"string":break;default:throw new Error('Invalid type for setting value: "'+typeof t+'".')}}var u=this;u.SETTING={SUGGESTIONS_AUTOFILL_ON_ROW_SELECT:"suggestionsAutofillOnRowSelect",SUGGESTIONS_SHOW_DIFFERENCE:"suggestionsShowDifference",SHOW_SUGGESTIONS:"showSuggestions",SUGGESTIONS_PANEL_HEIGHT:"suggestionsPanelHeight"};var l=u.SETTING,d={};d[l.SUGGESTIONS_AUTOFILL_ON_ROW_SELECT]=!0,d[l.SUGGESTIONS_SHOW_DIFFERENCE]=!1,d[l.SHOW_SUGGESTIONS]=!0,d[l.SUGGESTIONS_PANEL_HEIGHT]="30%";var f=r.clone(d);return{SETTING:l,update:o,updateAll:i,get:a,subscribe:s}}t.$inject=["EventService","$q","$rootScope","_"],angular.module("app").factory("SettingsService",t)}(),function(){"use strict";function t(t,e,n,r,o){function i(t){if("IMPORTED_TM"===t.type)return"3"+t.lastChanged;if("LOCAL_PROJECT"===t.type){if("Translated"===t.contentState)return"2"+t.lastModifiedDate;if("Approved"===t.contentState)return"1"+t.lastModifiedDate}return"9"}var a=this;return a.copyButtonText="Copy Translation",n.searchTerm="string"==typeof n.search?[n.search]:n.search.sources,a.rowDisplayType=function(){var t=a.topMatch();if("IMPORTED_TM"===t.type)return"secondary";if("LOCAL_PROJECT"===t.type){if("Translated"===t.contentState)return"success";if("Approved"===t.contentState)return"highlight"}console.error("Unable to generate row display type for top match")},a.percentDisplayType=function(){var t=a.rowDisplayType();return t.charAt(0).toUpperCase()+t.substring(1)},a.percent=function(){var t=n.suggestion.similarityPercent;return t>99.99&&100>t?"99.99":t>=99.9&&100>t?"99.9":Math.round(t)!==t?t.toFixed(1):t},a.topMatch=function(){return n.sortedDetails[0]},a.copySuggestion=function(){a.copyButtonText="Copied",a.copyButtonDisabled=!0,o(function(){a.copyButtonDisabled=!1,a.copyButtonText="Copy Translation"},500),t.emitEvent(t.EVENT.COPY_FROM_SUGGESTION,{suggestion:n.suggestion})},e.$on(t.EVENT.COPY_FROM_SUGGESTION_N,function(t,e){e===n.index&&a.copySuggestion()}),n.sortedDetails=r.sortBy(n.suggestion.matchDetails,i),n.translator=a.topMatch().lastModifiedBy,a}t.$inject=["EventService","$rootScope","$scope","_","$timeout"],angular.module("app").controller("SuggestionCtrl",t)}(),function(){"use strict";function t(t,e,n,r){function o(t){return a([t])}function i(t){return a(t.sources).then(function(n){return e.emitEvent(e.EVENT.PHRASE_SUGGESTION_COUNT,{id:t.id,count:n.length}),n})}function a(e){var o=t.context.srcLocale.localeId,i=t.context.localeId,a={query:{method:"POST",params:{from:o,to:i,searchType:"FUZZY_PLURAL"},isArray:!0}},s=r(n.SUGGESTIONS_URL,{},a);return s.query({},e).$promise}return{getSuggestionsForPhrase:i,getSuggestionsForText:o}}t.$inject=["EditorService","EventService","UrlService","$resource"],angular.module("app").factory("SuggestionsService",t)}(),function(){"use strict";function t(){return{restrict:"E",scope:{suggestion:"=",index:"=",search:"=",diffEnabled:"="},controller:"SuggestionCtrl as suggestionCtrl",templateUrl:"components/suggestions/suggestion.html"}}angular.module("app").directive("suggestion",t)}(),function(){"use strict";function t(){return{restrict:"A",link:function(t,e){e.after('<span class="Toggle-fakeCheckbox"></span>')}}}angular.module("app").directive("toggleCheckbox",t)}(),function(){"use strict";function t(t){function e(t){return t=angular.uppercase(t),t&&"NEW"!==t?"NEEDREVIEW"===t&&(t="NEEDSWORK"):t="UNTRANSLATED",t}function n(t){return t=angular.lowercase(t),t&&"untranslated"!==t?"needswork"===t?"NeedReview":t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():"New"}var r=this,o={UNTRANSLATED:{ID:"untranslated",NAME:"Untranslated",CSSCLASS:"neutral"},NEEDSWORK:{ID:"needswork",NAME:"Needs Work",CSSCLASS:"unsure"},TRANSLATED:{ID:"translated",NAME:"Translated",CSSCLASS:"success"},APPROVED:{ID:"approved",NAME:"Approved",CSSCLASS:"highlight"}};return r.getAll=function(){return o},r.getAllAsArray=function(){return t.values(o)},r.getStatusInfo=function(t){return o[e(t)]},r.getId=function(t){return o[e(t)].ID},r.getServerId=function(t){return n(t)},r.getName=function(t){return o[e(t)].NAME},r.getCSSClass=function(t){return o[e(t)].CSSCLASS},r}t.$inject=["_"],angular.module("app").factory("TransStatusService",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s,c,u,l,d){function f(){E.selected||e.$apply(function(){a.emitEvent(a.EVENT.SELECT_TRANS_UNIT,{id:e.phrase.id,updateURL:!0,focus:!0},e)})}var E=this;E.selected=!1,E.focused=!1,E.focusedTranslationIndex=0,E.hasTranslationChanged=l.hasTranslationChanged,E.focusTranslation=function(){E.selected&&c("phrase-"+e.phrase.id+"-"+E.focusedTranslationIndex)},E.onTextAreaFocus=function(t,n){E.focused=!0,o.isUndefined(n)||(E.focusedTranslationIndex=n),E.selected||a.emitEvent(a.EVENT.SELECT_TRANS_UNIT,{id:t.id,updateURL:!0,focus:!0},e)},E.translationTextModified=function(t){a.emitEvent(a.EVENT.TRANSLATION_TEXT_MODIFIED,t)},E.getPhrase=function(){return e.phrase},E.init=function(){i.addController(e.phrase.id,E),r.id&&parseInt(r.id)===e.phrase.id&&a.emitEvent(a.EVENT.SELECT_TRANS_UNIT,{id:r.id,updateURL:!1,focus:r.selected})},E.copySource=function(t,n,r){t.stopPropagation(),a.emitEvent(a.EVENT.COPY_FROM_SOURCE,{phrase:n,sourceIndex:r},e)},E.undoEdit=function(t,n){t.stopPropagation(),a.emitEvent(a.EVENT.UNDO_EDIT,n,e)},E.cancelEdit=function(t,n){t.stopPropagation(),a.emitEvent(a.EVENT.CANCEL_EDIT,n,e)},E.saveAs=function(t,e,n){u.saveTranslationCallBack(t,e,n)},E.getLocaleName=function(t){return s.getName(t)},E.toggleSaveAsOptions=function(t){a.broadcastEvent(t?"openDropdown":"closeDropdown",{},e),t&&c(e.phrase.id+"-saveAsOption-0")};var S=d.SETTING.SHOW_SUGGESTIONS;return e.showSuggestions=d.subscribe(S,function(t){e.showSuggestions=t}),t.$on(a.EVENT.SUGGESTIONS_SEARCH_TOGGLE,function(t,e){E.suggestionsSearchIsActive=e}),E.toggleSuggestionPanel=function(){E.suggestionsSearchIsActive?a.emitEvent(a.EVENT.SUGGESTIONS_SEARCH_TOGGLE,!1):d.update(S,!e.showSuggestions)},e.suggestionCount=0,t.$on(a.EVENT.PHRASE_SUGGESTION_COUNT,function(t,n){n.id===e.phrase.id&&(e.suggestionCount=n.count)}),E.cancelSaveAsMode=function(){u.cancelSaveAsModeIfOn()},e.$on("$destroy",function(){n.unbind("click",f),n.unbind("focus",f)}),E.updateSaveButton=function(t){E.saveButtonStatus=l.getSaveButtonStatus(e.phrase),E.saveButtonOptions=i.getSaveButtonOptions(E.saveButtonStatus,e.phrase),E.saveButtonText=E.saveButtonStatus.NAME,E.saveButtonDisabled=!l.hasTranslationChanged(t),E.loadingClass="",E.savingStatus=""},E.phraseSaving=function(t){E.loadingClass="is-loading",E.saveButtonStatus=E.savingStatus=t.status,E.saveButtonOptions=i.getSaveButtonOptions(E.saveButtonStatus,t.phrase),E.saveButtonText="Saving…",E.saveButtonDisabled=!0},E.saveButtonOptionsAvailable=function(){return!o.isEmpty(E.saveButtonOptions)},E.selectTransUnit=function(t){E.selected||a.emitEvent(a.EVENT.SELECT_TRANS_UNIT,{id:t.id,updateURL:!0,focus:!0},e)},E}t.$inject=["$rootScope","$scope","$element","$stateParams","_","TransUnitService","EventService","LocaleService","focus","EditorShortcuts","PhraseUtil","SettingsService"],angular.module("app").controller("TransUnitCtrl",t)}(),function(){"use strict";function t(t,e,n,r,o,i,a,s,c,u,l,d,f){function E(t,e){var n=0;if(t.plural){var r=N[t.id];n=r.focusedTranslationIndex}t.newTranslations[n]=e,s.emitEvent(s.EVENT.TRANSLATION_TEXT_MODIFIED,t),s.emitEvent(s.EVENT.FOCUS_TRANSLATION,t)}function S(t,e){t.newTranslations=e.slice(),s.emitEvent(s.EVENT.TRANSLATION_TEXT_MODIFIED,t),s.emitEvent(s.EVENT.FOCUS_TRANSLATION,t)}function g(t,e){var n=N[e.id];n.updateSaveButton(e)}function p(t,e){var n=N[e.phrase.id];n.phraseSaving(e),s.emitEvent(s.EVENT.FOCUS_TRANSLATION,e.phrase)}function T(t,e){t.selected!==e&&(t.selected=e||!1)}function h(t,e){var n=N[e.id];n.focusTranslation()}function v(t,e){var n=[];return"untranslated"===t.ID?n:(n=i("filter")(c.getAllAsArray(),{ID:"!untranslated"}),e.plural&&(d.hasNoTranslation(e)?n=i("filter")(n,{ID:"!needswork"}):d.hasEmptyTranslation(e)&&(n=i("filter")(n,{ID:"!translated"}))),u&&(n=i("filter")(n,{ID:"!approved"})),i("filter")(n,{ID:"!"+t.ID}))}var I,m=this,N={};return m.addController=function(t,e){N[t]=e},m.getSaveButtonOptions=function(t,e){return v(t,e)},n.$on(s.EVENT.TOGGLE_SAVE_OPTIONS,function(t,e){var n=N[e.id];n&&n.toggleSaveAsOptions(e.open)}),n.$on(s.EVENT.SELECT_TRANS_UNIT,function(t,n){var i=N[n.id],u=N[I],f=n.updateURL;s.emitEvent(s.EVENT.REQUEST_PHRASE_SUGGESTIONS,{phrase:i.getPhrase()}),i?(l.selectedTUCtrl=i,I&&I!==n.id&&(T(u,!1),d.hasTranslationChanged(u.getPhrase())&&s.emitEvent(s.EVENT.SAVE_TRANSLATION,{phrase:u.getPhrase(),status:c.getStatusInfo("TRANSLATED"),locale:o.localeId,docId:o.docId})),g(t,i.getPhrase()),I=n.id,T(i,!0),s.emitEvent(s.EVENT.FOCUS_TRANSLATION,n),f&&("editor.selectedContext.tu"!==r.current.name?r.go("editor.selectedContext.tu",{id:n.id,selected:n.focus.toString()}):(e.search("id",n.id),e.search("selected",n.focus.toString())))):a.displayWarning("Trans-unit not found:"+n.id)}),n.$on(s.EVENT.COPY_FROM_SOURCE,function(e,n){var r=0;if(n.phrase.plural&&(r=n.sourceIndex,t.isUndefined(r))){var o=N[n.phrase.id];r=o.focusedTranslationIndex,n.phrase.sources.length<o.focusedTranslationIndex+1&&(r=n.phrase.sources.length-1)}E(n.phrase,n.phrase.sources[r])}),n.$on(s.EVENT.COPY_FROM_SUGGESTION,function(e,n){if(I){var r=N[I],o=r.getPhrase(),i=n.suggestion,a=i.targetContents,s=o.plural&&a.length>1;if(s){var c=o.translations.length;if(a.length<c){var u=t.last(a);a=t.assign(o.translations.slice(),a,function(t,e){return e?e:t?t:u})}a.length>c&&(a=t.first(a,c)),S(o,a)}else E(o,a[0])}}),n.$on(s.EVENT.UNDO_EDIT,function(t,e){d.hasTranslationChanged(e)&&S(e,e.translations)}),n.$on(s.EVENT.CANCEL_EDIT,function(t,r){I&&(T(N[I],!1),I=!1,l.selectedTUCtrl=null),e.search("selected",null),r||e.search("id",null),r&&f(function(){return n.$broadcast("blurOn","phrase-"+r.id)})}),n.$on(s.EVENT.TRANSLATION_TEXT_MODIFIED,g),n.$on(s.EVENT.FOCUS_TRANSLATION,h),n.$on(s.EVENT.SAVE_INITIATED,p),n.$on(s.EVENT.SAVE_COMPLETED,g),m}t.$inject=["_","$location","$rootScope","$state","$stateParams","$filter","MessageHandler","EventService","TransStatusService","PRODUCTION","EditorShortcuts","PhraseUtil","$timeout"],angular.module("app").factory("TransUnitService",t)}(),function(){"use strict";function t(){return{restrict:"E",required:["phrase","editorContext"],scope:{phrase:"=",firstPhrase:"=",editorContext:"="},controller:"TransUnitCtrl as transUnitCtrl",templateUrl:"components/transUnit/trans-unit.html",link:function(t,e,n,r){r.init()}}}angular.module("app").directive("transUnit",t)}(),function(){"use strict";function t(){return{restrict:"E",required:["editor"],scope:{editor:"="},templateUrl:"components/transUnitFilter/trans-unit-filter.html"}}angular.module("app").directive("transUnitFilter",t)}(),function(){"use strict";function t(t,e){function n(n){var r=t(e.USER_INFO_URL,{},{query:{method:"GET",params:{username:n}}});return r.query().$promise}function r(){var n=t(e.MY_INFO_URL,{},{query:{method:"GET"}});return n.query().$promise}return{settings:{editor:{hideMainNav:!1}},getUserInfo:n,getMyInfo:r}}t.$inject=["$resource","UrlService"],angular.module("app").factory("UserService",t)}(),function(){"use strict";function t(t,e){function n(t,n,r){return t&&n&&r?e.filter(t,function(t){return i(t,n,r)}):t}function r(t){var e={},n=Object.keys(t).filter(function(t){return-1===t.indexOf("$")});return n.forEach(function(n){e[n]=t[n]}),e}function o(t){var e=[],n=Object.keys(t).filter(function(t){return-1===t.indexOf("$")});return n.forEach(function(n){e.push(t[n])}),e}function i(n,r,o){return n&&r&&o?e.any(r,function(r){return e.any(o,function(e){return t.equals(n[r],e,!0)})}):!1}return{filterResources:n,cleanResourceList:o,cleanResourceMap:r}}t.$inject=["StringUtil","_"],angular.module("app").factory("FilterUtil",t)}(),function(){"use strict";function t(t,e){function n(e){return o(e)?t.getStatusInfo("untranslated"):i(e)?t.getStatusInfo("needswork"):r(e)?t.getStatusInfo("translated"):e.status}function r(t){var n=e.every(t.translations,function(e,n){return a(e)===a(t.newTranslations[n])});return!n}function o(t){return e.isEmpty(e.compact(t.newTranslations))}function i(t){return e.compact(t.newTranslations).length!==t.newTranslations.length}function a(t){return t||""}return{getSaveButtonStatus:n,hasTranslationChanged:r,hasNoTranslation:o,hasEmptyTranslation:i}}t.$inject=["TransStatusService","_"],angular.module("app").factory("PhraseUtil",t)}(),function(){"use strict";function t(){return{getWordStatistic:function(t){return"WORD"===t[0].unit?t[0]:t[1]},getMsgStatistic:function(t){return"MESSAGE"===t[0].unit?t[0]:t[1]}}}angular.module("app").factory("StatisticUtil",t)}(),function(){"use strict";function t(){function t(t,e,n){return n&&t&&e&&(t=t.toUpperCase(),e=e.toUpperCase()),0===t.lastIndexOf(e,0)}function e(t,e,n){return n&&t&&e&&(t=t.toUpperCase(),e=e.toUpperCase()),-1!==t.indexOf(e,t.length-e.length)}function n(t,e,n){return n&&t&&e&&(t=t.toUpperCase(),e=e.toUpperCase()),t===e}return{startsWith:t,endsWith:e,equals:n}}angular.module("app").factory("StringUtil",t)}(),function(){"use strict";function t(t,e,n,r,o){function i(){return l+Array.prototype.join.call(arguments,"")}function a(t){return function(e){return t(e)}}location.origin||(location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var s=this,c="http://www.gravatar.com/avatar",u="config.json",l="",d={},f=location.origin+location.pathname+"translations";return s.serverContextPath="",s.init=function(){return l?n.when(l):e.get(u).then(function(t){var e=t.data;if(e.baseUrl)l=e.baseUrl;else{var n=e.appPath.replace(/^\//g,""),r=location.href.indexOf(n);s.serverContextPath=location.origin+location.pathname,r>=0&&(s.serverContextPath=location.href.substring(0,r)),s.serverContextPath=s.serverContextPath.replace(/\/?$/,"/"),l=s.serverContextPath+"rest"}d=o.mapValues({project:"/project/:projectSlug",docs:"/project/:projectSlug/version/:versionSlug/docs",locales:"/project/:projectSlug/version/:versionSlug/locales",status:"/project/:projectSlug/version/:versionSlug/doc/:docId/status/:localeId",textFlows:"/source+trans/:localeId",docStats:"/stats/project/:projectSlug/version/:versionSlug/doc/:docId/locale/:localeId",myInfo:"/user",userInfo:"/user/:username",translation:"/trans/:localeId",allLocales:"/locales",suggestions:"/suggestions"},a(i)),s.PROJECT_URL=d.project,s.LOCALE_LIST_URL=d.locales,s.DOCUMENT_LIST_URL=d.docs,s.TRANSLATION_STATUS_URL=d.status,s.TEXT_FLOWS_URL=d.textFlows,s.DOC_STATISTIC_URL=d.docStats,s.MY_INFO_URL=d.myInfo,s.USER_INFO_URL=d.userInfo,s.TRANSLATION_URL=d.translation,s.ALL_LOCALE_URL=d.allLocales,s.SUGGESTIONS_URL=d.suggestions,s.PROJECT_PAGE=function(t,e){return s.serverContextPath+"iteration/view/"+t+"/"+e},s.DASHBOARD_PAGE=s.serverContextPath+"dashboard"})},s.readValue=function(e){return t.search()[e]},s.gravatarUrl=function(t,e){return c+"/"+t+"?d=mm&amp;r=g&amp;s="+e},s.uiTranslationURL=function(t){return f+"/"+t+".json"},s.uiTranslationListURL=f+"/locales",s}t.$inject=["$location","$http","$q","$stateParams","_"],angular.module("app").factory("UrlService",t)}();
//# sourceMappingURL=../maps/app.js.map